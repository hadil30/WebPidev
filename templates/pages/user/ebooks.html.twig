{% extends 'pages/Interface_Communes/userinterface.html.twig' %}

{% block css %}   
    {{ parent() }}
    <link rel="shortcut icon" href="{{ asset('images/favicon.png') }}" type="">
    <title>Famms - Fashion HTML Template</title>
    <!-- bootstrap core css -->
    <link rel="stylesheet" type="text/css" href="{{ asset('cssbooks/bootstrap.css') }}" />
    <!-- font awesome style -->
    <link href="{{ asset('cssbooks/font-awesome.min.css') }}" rel="stylesheet" />
    <!-- Custom styles for this template -->
    <link href="{{ asset('cssbooks/style.css') }}" rel="stylesheet" />
    <!-- responsive style -->
    <link href="{{ asset('cssbooks/responsive.css') }}" rel="stylesheet" />
{% endblock %}

{% block content %}
<body class="sub_page">
    
      <!-- inner page section -->
      <br>
      <br>
      <br>

      <!-- end inner page section -->
      <!-- product section -->
      <section class="product_section layout_padding">
         <div class="container">
            <div class="heading_container heading_center">
               <h2>
                  Our <span>Books</span>
               </h2>
            </div>
            <div class="row">
               {% for book in b %}
               <div class="col-sm-6 col-md-4 col-lg-3">
                  <div class="box">
                     <div class="option_container">
                        <div class="options">
                           <a class="option1" 
                              data-book-id="{{ book.idLiv }}" 
                              data-pdf-path="{{ book.pdfPath }}"
                              data-title="{{ book.nomLiv }}"
                              data-image="{{ asset('assets/' ~ book.imagePath) }}"
                              data-price="{{ book.prixLiv }}">
                              Add To Collection
                           </a>
                           <a class="option2">
                              Buy Now
                           </a>
                        </div>
                     </div>
                     <div class="img-box">
                         <img src="{{ asset('assets/' ~ book.imagePath) }}" class="card-img-top" alt="Avatar">
                     </div>
                     <div class="detail-box">
                        <h5>
                           {{ book.nomLiv }}
                        </h5>
                        <h6>
                           ${{ book.prixLiv }}
                        </h6>
                     </div>
                  </div>
               </div>
               {% endfor %}
            </div>
            <div class="btn-box">
               <a href="">
               My Collection
               </a>
            </div>
         </div>
      </section>
      <!-- end product section -->
      <!-- footer section -->
      <footer class="footer_section">
         <div class="container">
            <!-- Footer content here -->
         </div>
      </footer>
      <!-- footer section -->
      <!-- jQuery -->
      <script src="{{ asset('jsbooks/jquery-3.4.1.min.js') }}"></script>
      <!-- popper js -->
      <script src="{{ asset('jsbooks/popper.min.js') }}"></script>
      <!-- bootstrap js -->
      <script src="{{ asset('jsbooks/bootstrap.js') }}"></script>
      <!-- custom js -->
      <script src="{{ asset('jsbooks/custom.js') }}"></script>
      <script>
        $(document).ready(function() {
            $('.option1').click(function(event) {
                event.preventDefault(); // Empêche le comportement par défaut du lien

                var bookId = $(this).data('book-id');
                var bookTitle = $(this).data('title');
                var bookImage = $(this).data('image');
                var bookPrice = $(this).data('price');
                var bookPdfPath = $(this).data('pdf-path');

                $.ajax({
                    url: '/add-to-cart/' + bookId,
                    type: 'POST',
                    data: {
                        NomLiv: bookTitle,
                        ImagePath: bookImage,
                        PrixLiv: bookPrice,
                        PdfPath: bookPdfPath
                    },
                    success: function(response) {
                        // Gérer la réponse en cas de succès, par exemple afficher un message à l'utilisateur
                        alert('Livre ajouté au panier!');
                    },
                    error: function(xhr, status, error) {
                        // Gérer les erreurs, par exemple afficher un message d'erreur à l'utilisateur
                        alert('Une erreur est survenue lors de l\'ajout du livre au panier.');
                    }
                });
            });
        });
    </script>
   </body>
{% endblock %}
